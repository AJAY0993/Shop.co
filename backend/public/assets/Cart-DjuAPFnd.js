import{f as b,d as i,h as I,a as w,j as e,B as u,p as $,o as S,q as C,L as A,T as G,n as M,g as q,N as O,P as R,e as D,s as J,t as W,v as _,r as z,w as Q}from"./index-Dxkm9OBN.js";import{b as X,H as U}from"./Header-DiS-RBAy.js";import{R as m,N as V,F as B}from"./Footer-B8n9YJ6A.js";import{C as H}from"./CartController-BDmQLSe-.js";import{C as Y}from"./Container-D8XsSa1w.js";import{M as j}from"./Modal-CetgO2M2.js";

function K({cartItem:t}){const r=b(); const a=(i(I(t._id))*t.price.current.value).toFixed(2); const n=w(); const o=()=>n($(t._id)); const l=h=>{h.stopPropagation(),r(`/shop/${t._id}`)};return e.jsx("div",{children:e.jsxs(m,{classes:"py-2 gap-[.75rem] md:gap-4 items-center relative",children:[e.jsx("img",{className:"aspect-square h-20 rounded-xl object-cover object-top md:h-32",src:t.imageUrl}),e.jsxs("div",{children:[e.jsx("h5",{className:" max-w-[80%] cursor-pointer text-base font-semibold md:text-xl",onClick:l,children:t.name}),e.jsxs("p",{className:"text-[.8rem] md:text-base",children:["size ",e.jsx("span",{children:"7"})]}),e.jsxs("p",{className:"text-[.8rem] md:text-base",children:["color ",e.jsx("span",{children:"red"})]}),e.jsxs("span",{className:"font-semibold md:text-lg",children:["$",a]})]}),e.jsx("div",{className:"absolute right-2 top-2",children:e.jsx(u,{type:"raw",children:e.jsx(X,{className:"text-stone-600 hover:text-red-600",onClick:o})})}),e.jsx("div",{className:"absolute bottom-2 right-2 flex flex-col justify-self-end",children:e.jsx(H,{product:t})})]})})}function Z(){return e.jsxs("div",{className:"mx-auto flex  max-w-80 flex-col gap-8 text-center",children:[e.jsx("img",{src:"/emptyCart.svg"}),e.jsx(S,{children:"I am empty"}),e.jsx("div",{children:e.jsx(u,{type:"primary",to:"/shop",children:"Go and Add"})})]})}function ee(){const t=i(C);return e.jsx(A,{className:" flex-grow-5 divide-y-[1px] rounded-3xl border-2 border-stone-400 p-2 md:p-6 ",items:t,render:r=>e.jsx(K,{cartItem:r},Math.random().toString(36).slice(2,6)),emptyListItem:e.jsx(Z,{})})}function re(){return e.jsx(G,{align:"left",children:"Your cart"})}function x({name:t,value:r,color:s="neutral-950"}){return e.jsx("li",{children:e.jsxs("div",{className:"flex justify-between capitalize",children:[e.jsx("span",{className:"text-stone-500",children:t}),e.jsx("span",{className:`font-semibold text-${s}`,children:r})]})})}const N="https://js.stripe.com/v3"; const te=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/; const v="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used"; const se=function(){for(let r=document.querySelectorAll('script[src^="'.concat(N,'"]')),s=0;s<r.length;s++){const a=r[s];if(te.test(a.src))return a}return null}; const y=function(r){const s=r&&!r.advancedFraudSignals?"?advancedFraudSignals=false":""; const a=document.createElement("script");a.src="".concat(N).concat(s);const n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(a),a}; const ne=function(r,s){!r||!r._registerWrapper||r._registerWrapper({name:"stripe-js",version:"3.3.0",startTime:s})}; let c=null; let p=null; let f=null; const ae=function(r){return function(){r(new Error("Failed to load Stripe.js"))}}; const oe=function(r,s){return function(){window.Stripe?r(window.Stripe):s(new Error("Stripe.js not available"))}}; const ie=function(r){return c!==null?c:(c=new Promise((s,a) =>{if(typeof window>"u"||typeof document>"u"){s(null);return}if(window.Stripe&&r&&console.warn(v),window.Stripe){s(window.Stripe);return}try{let n=se();if(n&&r)console.warn(v);else if(!n)n=y(r);else if(n&&f!==null&&p!==null){let o;n.removeEventListener("load",f),n.removeEventListener("error",p),(o=n.parentNode)===null||o===void 0||o.removeChild(n),n=y(r)}f=oe(s,a),p=ae(a),n.addEventListener("load",f),n.addEventListener("error",p)}catch(l){a(l);}}),c.catch((s) =>(c=null,Promise.reject(s))))}; const le=function(r,s,a){if(r===null)return null;const n=r.apply(void 0,s);return ne(n,a),n}; let d; let E=!1; const P=function(){return d||(d=ie(null).catch((r) =>(d=null,Promise.reject(r))),d)};Promise.resolve().then(() =>P()).catch((t) =>{E||console.warn(t)});const ce=function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];E=!0;const n=Date.now();return P().then((o) =>le(o,s,n))};const de=async t=>(await M("checkout",{method:"POST",data:{items:t}})).data.data.session;function ue({onSubmit:t,isCheckingOut:r}){const s=i(q); const a=o=>{o.preventDefault(),t()}; const n="block flex-grow  rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-stone-500 focus:ring-stone-500  ";return s?e.jsx(R,{children:e.jsx("div",{className:"min-w-72 rounded-lg bg-neutral-50 p-4",children:e.jsxs("form",{className:"space-y-4",onSubmit:a,children:[e.jsxs(m,{classes:"flex-col ",children:[e.jsx("label",{htmlFor:"address",className:"text-gray-90 mb-2 block text-sm font-medium",children:"Shipping Address"}),e.jsx("textarea",{id:"address",rows:"4",className:n,placeholder:"Shipping Address",required:!0,defaultValue:s.address})]}),e.jsxs(m,{classes:"flex-col",children:[e.jsx("label",{htmlFor:"Mob no",className:"text-gray-90 mb-2 block text-sm font-medium",children:"Mob no"}),e.jsx("input",{type:"tel",className:n,required:!0})]}),e.jsx(u,{type:"primary",size:"sm",loading:r,disabled:r,children:"Confirm"})]})})}):e.jsx(O,{replace:!0,to:"/login"})}function me(){const t=b(); const r=w(); const s=i(D); const a=i(C); const n=i(J); const o=i(W); const l=i(_); const [h,g]=z.useState(!1); const L=(n+l-o).toFixed(2); const F=async()=>{if(!s)return t("/login");const k=await ce("pk_test_51P4fQhSGowosMs9tJozifuX1d39JCzydl9JJbbF5CCX5GpCYJII4eXFbfO26KM7kGpVt7yP1oMDakQNlpL1lDGky00lJWmS5gq");g(!0);const T=await de(a);g(!1),r(Q()),k.redirectToCheckout({sessionId:T.id})};return a.length<1?null:e.jsxs("div",{className:"flex-grow  self-start rounded-3xl border-2 border-stone-400 px-2 py-2 sm:px-4 md:flex-grow-0",children:[e.jsx(S,{children:"Order summary"}),e.jsxs("ul",{className:"flex flex-col gap-3 py-4",children:[e.jsx(x,{name:"subtotal",value:`$${n}`}),e.jsx(x,{name:"discount",value:`$${o}`,color:"red-600"}),e.jsx(x,{name:"delievery fee",value:`$${l}`}),e.jsx(x,{name:"total price",value:`$${L}`})]}),e.jsxs(m,{classes:"flex-nowrap gap-2 my-2 ",children:[e.jsx("input",{className:"flex flex-grow rounded-full bg-stone-200 px-4 py-2",placeholder:"Apply promo code"}),e.jsx(u,{type:"primary",children:"apply"})]}),e.jsx("div",{className:"mx-auto my-2 w-[16rem] md:w-96",children:e.jsxs(j,{children:[e.jsx(j.Open,{children:e.jsxs(u,{type:"primary",enlarge:!1,children:["Go to checkout",e.jsx("span",{className:"mx-2 transition-all hover:translate-x-8",children:"â†’"})]})}),e.jsx(j.Window,{children:e.jsx(ue,{onSubmit:F,isCheckingOut:h})})]})})]})}function ve(){return e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsxs(Y,{className:"px-2",children:[e.jsx(re,{}),e.jsxs(m,{classes:"flex-wrap gap-2",children:[e.jsx(ee,{}),e.jsx(me,{})]})]}),e.jsx(V,{}),e.jsx(B,{})]})}export{ve as default};
