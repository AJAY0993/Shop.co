import{f as b,d as i,h as A,a as w,j as e,B as u,q as F,o as S,s as C,L as $,T as G,n as M,g as q,N as O,P as R,e as D,t as J,v as W,w as _,r as z,x as Q}from"./index-00F4N1Wb.js";import{b as X,M as j}from"./Header-CF4FsExV.js";import{R as m}from"./NewsletterSubscriptionForm-BeEsRt-B.js";import{C as U}from"./CartController-CCXtlCct.js";import{C as V}from"./Container-BsgEogkW.js";import{A as B}from"./AppLayout-DRTtMgjg.js";function Y({cartItem:t}){const r=b(),a=(i(A(t._id))*t.price.current.value).toFixed(2),n=w(),o=()=>n(F(t._id)),l=h=>{h.stopPropagation(),r(`/shop/${t._id}`)};return e.jsx("div",{children:e.jsxs(m,{classes:"py-2 gap-[.75rem] md:gap-4 items-center relative",children:[e.jsx("img",{className:"aspect-square h-20 rounded-xl object-cover object-top md:h-32",src:t.imageUrl}),e.jsxs("div",{children:[e.jsx("h5",{className:" max-w-[80%] cursor-pointer text-base font-semibold md:text-xl",onClick:l,children:t.name}),e.jsxs("p",{className:"text-[.8rem] md:text-base",children:["size ",e.jsx("span",{children:"7"})]}),e.jsxs("p",{className:"text-[.8rem] md:text-base",children:["color ",e.jsx("span",{children:"red"})]}),e.jsxs("span",{className:"font-semibold md:text-lg",children:["$",a]})]}),e.jsx("div",{className:"absolute right-2 top-2",children:e.jsx(u,{type:"raw",children:e.jsx(X,{className:"text-stone-600 hover:text-red-600",onClick:o})})}),e.jsx("div",{className:"absolute bottom-2 right-2 flex flex-col justify-self-end",children:e.jsx(U,{product:t})})]})})}function K(){return e.jsxs("div",{className:"mx-auto flex  max-w-80 flex-col gap-8 text-center",children:[e.jsx("img",{src:"/emptyCart.svg"}),e.jsx(S,{children:"I am empty"}),e.jsx("div",{children:e.jsx(u,{type:"primary",to:"/shop",children:"Go and Add"})})]})}function H(){const t=i(C);return e.jsx($,{className:" flex-grow-5 divide-y-[1px] rounded-3xl border-2 border-stone-400 p-2 md:p-6 ",items:t,render:r=>e.jsx(Y,{cartItem:r},Math.random().toString(36).slice(2,6)),emptyListItem:e.jsx(K,{})})}function Z(){return e.jsx(G,{align:"left",children:"Your cart"})}function x({name:t,value:r,color:s="neutral-950"}){return e.jsx("li",{children:e.jsxs("div",{className:"flex justify-between capitalize",children:[e.jsx("span",{className:"text-stone-500",children:t}),e.jsx("span",{className:`font-semibold text-${s}`,children:r})]})})}var N="https://js.stripe.com/v3",ee=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,g="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",re=function(){for(var r=document.querySelectorAll('script[src^="'.concat(N,'"]')),s=0;s<r.length;s++){var a=r[s];if(ee.test(a.src))return a}return null},y=function(r){var s=r&&!r.advancedFraudSignals?"?advancedFraudSignals=false":"",a=document.createElement("script");a.src="".concat(N).concat(s);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(a),a},te=function(r,s){!r||!r._registerWrapper||r._registerWrapper({name:"stripe-js",version:"3.3.0",startTime:s})},c=null,p=null,f=null,se=function(r){return function(){r(new Error("Failed to load Stripe.js"))}},ne=function(r,s){return function(){window.Stripe?r(window.Stripe):s(new Error("Stripe.js not available"))}},ae=function(r){return c!==null?c:(c=new Promise(function(s,a){if(typeof window>"u"||typeof document>"u"){s(null);return}if(window.Stripe&&r&&console.warn(g),window.Stripe){s(window.Stripe);return}try{var n=re();if(n&&r)console.warn(g);else if(!n)n=y(r);else if(n&&f!==null&&p!==null){var o;n.removeEventListener("load",f),n.removeEventListener("error",p),(o=n.parentNode)===null||o===void 0||o.removeChild(n),n=y(r)}f=ne(s,a),p=se(a),n.addEventListener("load",f),n.addEventListener("error",p)}catch(l){a(l);return}}),c.catch(function(s){return c=null,Promise.reject(s)}))},oe=function(r,s,a){if(r===null)return null;var n=r.apply(void 0,s);return te(n,a),n},d,E=!1,L=function(){return d||(d=ae(null).catch(function(r){return d=null,Promise.reject(r)}),d)};Promise.resolve().then(function(){return L()}).catch(function(t){E||console.warn(t)});var ie=function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];E=!0;var n=Date.now();return L().then(function(o){return oe(o,s,n)})};const le=async t=>(await M("checkout",{method:"POST",data:{items:t}})).data.data.session;function ce({onSubmit:t,isCheckingOut:r}){const s=i(q),a=o=>{o.preventDefault(),t()},n="block flex-grow  rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-stone-500 focus:ring-stone-500  ";return s?e.jsx(R,{children:e.jsx("div",{className:"min-w-72 rounded-lg bg-neutral-50 p-4",children:e.jsxs("form",{className:"space-y-4",onSubmit:a,children:[e.jsxs(m,{classes:"flex-col ",children:[e.jsx("label",{htmlFor:"address",className:"text-gray-90 mb-2 block text-sm font-medium",children:"Shipping Address"}),e.jsx("textarea",{id:"address",rows:"4",className:n,placeholder:"Shipping Address",required:!0,defaultValue:s.address})]}),e.jsxs(m,{classes:"flex-col",children:[e.jsx("label",{htmlFor:"Mob no",className:"text-gray-90 mb-2 block text-sm font-medium",children:"Mob no"}),e.jsx("input",{type:"tel",className:n,required:!0})]}),e.jsx(u,{type:"primary",size:"sm",loading:r,disabled:r,children:"Confirm"})]})})}):e.jsx(O,{replace:!0,to:"/login"})}function de(){const t=b(),r=w(),s=i(D),a=i(C),n=i(J),o=i(W),l=i(_),[h,v]=z.useState(!1),P=(n+l-o).toFixed(2),k=async()=>{if(!s)return t("/login");const T=await ie("pk_test_51P4fQhSGowosMs9tJozifuX1d39JCzydl9JJbbF5CCX5GpCYJII4eXFbfO26KM7kGpVt7yP1oMDakQNlpL1lDGky00lJWmS5gq");v(!0);const I=await le(a);v(!1),r(Q()),T.redirectToCheckout({sessionId:I.id})};return a.length<1?null:e.jsxs("div",{className:"flex-grow  self-start rounded-3xl border-2 border-stone-400 px-2 py-2 sm:px-4 md:flex-grow-0",children:[e.jsx(S,{children:"Order summary"}),e.jsxs("ul",{className:"flex flex-col gap-3 py-4",children:[e.jsx(x,{name:"subtotal",value:`$${n}`}),e.jsx(x,{name:"discount",value:`$${o}`,color:"red-600"}),e.jsx(x,{name:"delievery fee",value:`$${l}`}),e.jsx(x,{name:"total price",value:`$${P}`})]}),e.jsxs(m,{classes:"flex-nowrap gap-2 my-2 ",children:[e.jsx("input",{className:"flex flex-grow rounded-full bg-stone-200 px-4 py-2",placeholder:"Apply promo code"}),e.jsx(u,{type:"primary",children:"apply"})]}),e.jsx("div",{className:"mx-auto my-2 w-[16rem] md:w-96",children:e.jsxs(j,{children:[e.jsx(j.Open,{children:e.jsxs(u,{type:"primary",enlarge:!1,children:["Go to checkout",e.jsx("span",{className:"mx-2 transition-all hover:translate-x-8",children:"â†’"})]})}),e.jsx(j.Window,{children:e.jsx(ce,{onSubmit:k,isCheckingOut:h})})]})})]})}function je(){return e.jsx(B,{children:e.jsxs(V,{className:"px-2",children:[e.jsx(Z,{}),e.jsxs(m,{classes:"flex-wrap gap-2",children:[e.jsx(H,{}),e.jsx(de,{})]})]})})}export{je as default};
