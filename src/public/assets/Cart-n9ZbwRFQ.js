import{a as i,g as I,b as y,j as e,e as T,f as b,h as A,i as $,P as G,u as M,k as O,l as R,m as q,n as D,r as J,o as W}from"./index-yjcIFYCJ.js";import{L as z}from"./List-CNyMGk0O.js";import{R as d,c as Q,H as X,N as _,F as U}from"./Header-CpMF560h.js";import{B as u,T as V}from"./Button-BA2p-PeP.js";import{C as B}from"./CartController-DMl5Xvqw.js";import{S as w}from"./Subtitle-HI-oxLdF.js";import{C as H}from"./Container-BoIsmwHk.js";import{M as h}from"./Modal-Cwluzxb1.js";function Y({cartItem:s}){const t=(i(I(s._id))*s.price.current.value).toFixed(2),a=y(),n=()=>a(T(s._id));return e.jsx("div",{children:e.jsxs(d,{classes:"py-2 gap-[.75rem] md:gap-4 items-center relative",children:[e.jsx("img",{className:"aspect-square h-20 rounded-xl object-cover object-top md:h-32",src:s.imageUrl}),e.jsxs("div",{children:[e.jsx("h5",{className:" max-w-[80%] text-base font-semibold md:text-xl",children:s.name}),e.jsxs("p",{className:"text-[.8rem] md:text-base",children:["size ",e.jsx("span",{children:"7"})]}),e.jsxs("p",{className:"text-[.8rem] md:text-base",children:["color ",e.jsx("span",{children:"red"})]}),e.jsxs("span",{className:"font-semibold md:text-lg",children:["$",t]})]}),e.jsx("div",{className:"absolute right-2 top-2",children:e.jsx(u,{type:"raw",children:e.jsx(Q,{className:"text-stone-600 hover:text-red-600",onClick:n})})}),e.jsx("div",{className:"absolute bottom-2 right-2 flex flex-col justify-self-end",children:e.jsx(B,{product:s})})]})})}function K(){return e.jsxs("div",{className:"mx-auto flex  max-w-80 flex-col gap-8 text-center",children:[e.jsx("img",{src:"/emptyCart.svg"}),e.jsx(w,{children:"I am empty"}),e.jsx("div",{children:e.jsx(u,{type:"primary",to:"/shop",children:"Go and Add"})})]})}function Z(){const s=i(b);return e.jsx(z,{className:" flex-grow-5 divide-y-[1px] rounded-3xl border-2 border-stone-400 p-2 md:p-6 ",items:s,render:r=>e.jsx(Y,{cartItem:r},Math.random().toString(36).slice(2,6)),emptyListItem:e.jsx(K,{})})}function ee(){return e.jsx(V,{align:"left",children:"Your cart"})}function x({name:s,value:r,color:t="neutral-950"}){return e.jsx("li",{children:e.jsxs("div",{className:"flex justify-between capitalize",children:[e.jsx("span",{className:"text-stone-500",children:s}),e.jsx("span",{className:`font-semibold text-${t}`,children:r})]})})}var S="https://js.stripe.com/v3",re=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,v="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",te=function(){for(var r=document.querySelectorAll('script[src^="'.concat(S,'"]')),t=0;t<r.length;t++){var a=r[t];if(re.test(a.src))return a}return null},g=function(r){var t=r&&!r.advancedFraudSignals?"?advancedFraudSignals=false":"",a=document.createElement("script");a.src="".concat(S).concat(t);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(a),a},se=function(r,t){!r||!r._registerWrapper||r._registerWrapper({name:"stripe-js",version:"3.3.0",startTime:t})},l=null,p=null,f=null,ne=function(r){return function(){r(new Error("Failed to load Stripe.js"))}},ae=function(r,t){return function(){window.Stripe?r(window.Stripe):t(new Error("Stripe.js not available"))}},oe=function(r){return l!==null?l:(l=new Promise(function(t,a){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&r&&console.warn(v),window.Stripe){t(window.Stripe);return}try{var n=te();if(n&&r)console.warn(v);else if(!n)n=g(r);else if(n&&f!==null&&p!==null){var o;n.removeEventListener("load",f),n.removeEventListener("error",p),(o=n.parentNode)===null||o===void 0||o.removeChild(n),n=g(r)}f=ae(t,a),p=ne(a),n.addEventListener("load",f),n.addEventListener("error",p)}catch(m){a(m);return}}),l.catch(function(t){return l=null,Promise.reject(t)}))},ie=function(r,t,a){if(r===null)return null;var n=r.apply(void 0,t);return se(n,a),n},c,C=!1,N=function(){return c||(c=oe(null).catch(function(r){return c=null,Promise.reject(r)}),c)};Promise.resolve().then(function(){return N()}).catch(function(s){C||console.warn(s)});var le=function(){for(var r=arguments.length,t=new Array(r),a=0;a<r;a++)t[a]=arguments[a];C=!0;var n=Date.now();return N().then(function(o){return ie(o,t,n)})};const ce=async s=>(await A("checkout",{method:"POST",data:{items:s}})).data.data.session;function de({onSubmit:s,isCheckingOut:r}){const t=i($),a=o=>{o.preventDefault(),s()},n="block flex-grow  rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-stone-500 focus:ring-stone-500  ";return e.jsx(G,{children:e.jsx("div",{className:"min-w-72 rounded-lg bg-neutral-50 p-4",children:e.jsxs("form",{className:"space-y-4",onSubmit:a,children:[e.jsxs(d,{classes:"flex-col ",children:[e.jsx("label",{htmlFor:"address",className:"text-gray-90 mb-2 block text-sm font-medium",children:"Shipping Address"}),e.jsx("textarea",{id:"address",rows:"4",className:n,placeholder:"Shipping Address",required:!0,defaultValue:t.address})]}),e.jsxs(d,{classes:"flex-col",children:[e.jsx("label",{htmlFor:"Mob no",className:"text-gray-90 mb-2 block text-sm font-medium",children:"Mob no"}),e.jsx("input",{type:"tel",className:n,required:!0})]}),e.jsx(u,{type:"primary",size:"sm",loading:r,disabled:r,children:"Confirm"})]})})})}function ue(){const s=M(),r=y(),t=i(O),a=i(b),n=i(R),o=i(q),m=i(D),[E,j]=J.useState(!1),L=(n+m-o).toFixed(2),F=async()=>{if(!t)return s("/login");const P=await le("pk_test_51P4fQhSGowosMs9tJozifuX1d39JCzydl9JJbbF5CCX5GpCYJII4eXFbfO26KM7kGpVt7yP1oMDakQNlpL1lDGky00lJWmS5gq");j(!0);const k=await ce(a);j(!1),r(W()),P.redirectToCheckout({sessionId:k.id})};return a.length<1?null:e.jsxs("div",{className:"flex-grow  self-start rounded-3xl border-2 border-stone-400 px-2 py-2 sm:px-4 md:flex-grow-0",children:[e.jsx(w,{children:"Order summary"}),e.jsxs("ul",{className:"flex flex-col gap-3 py-4",children:[e.jsx(x,{name:"subtotal",value:`$${n}`}),e.jsx(x,{name:"discount",value:`$${o}`,color:"red-600"}),e.jsx(x,{name:"delievery fee",value:`$${m}`}),e.jsx(x,{name:"total price",value:`$${L}`})]}),e.jsxs(d,{classes:"flex-nowrap gap-2 my-2 ",children:[e.jsx("input",{className:"flex flex-grow rounded-full bg-stone-200 px-4 py-2",placeholder:"Apply promo code"}),e.jsx(u,{type:"primary",children:"apply"})]}),e.jsx("div",{className:"mx-auto my-2 w-[16rem] md:w-96",children:e.jsxs(h,{children:[e.jsx(h.Open,{children:e.jsxs(u,{type:"primary",enlarge:!1,children:["Go to checkout",e.jsx("span",{className:"mx-2 transition-all hover:translate-x-8",children:"â†’"})]})}),e.jsx(h.Window,{children:e.jsx(de,{onSubmit:F,isCheckingOut:E})})]})})]})}function ye(){return e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsxs(H,{className:"px-2",children:[e.jsx(ee,{}),e.jsxs(d,{classes:"flex-wrap gap-2",children:[e.jsx(Z,{}),e.jsx(ue,{})]})]}),e.jsx(_,{}),e.jsx(U,{})]})}export{ye as default};
