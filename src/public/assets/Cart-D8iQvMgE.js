import{u as b,a as i,g as I,b as w,j as e,i as $,k as S,e as A,l as G,P as M,m as q,n as O,o as R,p as D,r as J,q as W}from"./index-B9li8m8z.js";import{L as _}from"./List-8unKWnc1.js";import{R as u,c as z,H as Q,N as X,F as U}from"./Header-YPTMm3Ox.js";import{B as m,T as V}from"./Button-CvSk2pmn.js";import{C as B}from"./CartController-DFBQN4T_.js";import{S as C}from"./Subtitle-Bo2cKDZd.js";import{C as H}from"./Container-JWH7R6nI.js";import{M as j}from"./Modal-H3rj5KVh.js";function Y({cartItem:t}){const r=b(),a=(i(I(t._id))*t.price.current.value).toFixed(2),n=w(),o=()=>n($(t._id)),l=h=>{h.stopPropagation(),r(`/shop/${t._id}`)};return e.jsx("div",{children:e.jsxs(u,{classes:"py-2 gap-[.75rem] md:gap-4 items-center relative",children:[e.jsx("img",{className:"aspect-square h-20 rounded-xl object-cover object-top md:h-32",src:t.imageUrl}),e.jsxs("div",{children:[e.jsx("h5",{className:" max-w-[80%] cursor-pointer text-base font-semibold md:text-xl",onClick:l,children:t.name}),e.jsxs("p",{className:"text-[.8rem] md:text-base",children:["size ",e.jsx("span",{children:"7"})]}),e.jsxs("p",{className:"text-[.8rem] md:text-base",children:["color ",e.jsx("span",{children:"red"})]}),e.jsxs("span",{className:"font-semibold md:text-lg",children:["$",a]})]}),e.jsx("div",{className:"absolute right-2 top-2",children:e.jsx(m,{type:"raw",children:e.jsx(z,{className:"text-stone-600 hover:text-red-600",onClick:o})})}),e.jsx("div",{className:"absolute bottom-2 right-2 flex flex-col justify-self-end",children:e.jsx(B,{product:t})})]})})}function K(){return e.jsxs("div",{className:"mx-auto flex  max-w-80 flex-col gap-8 text-center",children:[e.jsx("img",{src:"/emptyCart.svg"}),e.jsx(C,{children:"I am empty"}),e.jsx("div",{children:e.jsx(m,{type:"primary",to:"/shop",children:"Go and Add"})})]})}function Z(){const t=i(S);return e.jsx(_,{className:" flex-grow-5 divide-y-[1px] rounded-3xl border-2 border-stone-400 p-2 md:p-6 ",items:t,render:r=>e.jsx(Y,{cartItem:r},Math.random().toString(36).slice(2,6)),emptyListItem:e.jsx(K,{})})}function ee(){return e.jsx(V,{align:"left",children:"Your cart"})}function x({name:t,value:r,color:s="neutral-950"}){return e.jsx("li",{children:e.jsxs("div",{className:"flex justify-between capitalize",children:[e.jsx("span",{className:"text-stone-500",children:t}),e.jsx("span",{className:`font-semibold text-${s}`,children:r})]})})}var N="https://js.stripe.com/v3",re=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,v="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",te=function(){for(var r=document.querySelectorAll('script[src^="'.concat(N,'"]')),s=0;s<r.length;s++){var a=r[s];if(re.test(a.src))return a}return null},y=function(r){var s=r&&!r.advancedFraudSignals?"?advancedFraudSignals=false":"",a=document.createElement("script");a.src="".concat(N).concat(s);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(a),a},se=function(r,s){!r||!r._registerWrapper||r._registerWrapper({name:"stripe-js",version:"3.3.0",startTime:s})},c=null,p=null,f=null,ne=function(r){return function(){r(new Error("Failed to load Stripe.js"))}},ae=function(r,s){return function(){window.Stripe?r(window.Stripe):s(new Error("Stripe.js not available"))}},oe=function(r){return c!==null?c:(c=new Promise(function(s,a){if(typeof window>"u"||typeof document>"u"){s(null);return}if(window.Stripe&&r&&console.warn(v),window.Stripe){s(window.Stripe);return}try{var n=te();if(n&&r)console.warn(v);else if(!n)n=y(r);else if(n&&f!==null&&p!==null){var o;n.removeEventListener("load",f),n.removeEventListener("error",p),(o=n.parentNode)===null||o===void 0||o.removeChild(n),n=y(r)}f=ae(s,a),p=ne(a),n.addEventListener("load",f),n.addEventListener("error",p)}catch(l){a(l);return}}),c.catch(function(s){return c=null,Promise.reject(s)}))},ie=function(r,s,a){if(r===null)return null;var n=r.apply(void 0,s);return se(n,a),n},d,E=!1,P=function(){return d||(d=oe(null).catch(function(r){return d=null,Promise.reject(r)}),d)};Promise.resolve().then(function(){return P()}).catch(function(t){E||console.warn(t)});var le=function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];E=!0;var n=Date.now();return P().then(function(o){return ie(o,s,n)})};const ce=async t=>(await A("checkout",{method:"POST",data:{items:t}})).data.data.session;function de({onSubmit:t,isCheckingOut:r}){const s=i(G),a=o=>{o.preventDefault(),t()},n="block flex-grow  rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-stone-500 focus:ring-stone-500  ";return e.jsx(M,{children:e.jsx("div",{className:"min-w-72 rounded-lg bg-neutral-50 p-4",children:e.jsxs("form",{className:"space-y-4",onSubmit:a,children:[e.jsxs(u,{classes:"flex-col ",children:[e.jsx("label",{htmlFor:"address",className:"text-gray-90 mb-2 block text-sm font-medium",children:"Shipping Address"}),e.jsx("textarea",{id:"address",rows:"4",className:n,placeholder:"Shipping Address",required:!0,defaultValue:s.address})]}),e.jsxs(u,{classes:"flex-col",children:[e.jsx("label",{htmlFor:"Mob no",className:"text-gray-90 mb-2 block text-sm font-medium",children:"Mob no"}),e.jsx("input",{type:"tel",className:n,required:!0})]}),e.jsx(m,{type:"primary",size:"sm",loading:r,disabled:r,children:"Confirm"})]})})})}function ue(){const t=b(),r=w(),s=i(q),a=i(S),n=i(O),o=i(R),l=i(D),[h,g]=J.useState(!1),L=(n+l-o).toFixed(2),F=async()=>{if(!s)return t("/login");const k=await le("pk_test_51P4fQhSGowosMs9tJozifuX1d39JCzydl9JJbbF5CCX5GpCYJII4eXFbfO26KM7kGpVt7yP1oMDakQNlpL1lDGky00lJWmS5gq");g(!0);const T=await ce(a);g(!1),r(W()),k.redirectToCheckout({sessionId:T.id})};return a.length<1?null:e.jsxs("div",{className:"flex-grow  self-start rounded-3xl border-2 border-stone-400 px-2 py-2 sm:px-4 md:flex-grow-0",children:[e.jsx(C,{children:"Order summary"}),e.jsxs("ul",{className:"flex flex-col gap-3 py-4",children:[e.jsx(x,{name:"subtotal",value:`$${n}`}),e.jsx(x,{name:"discount",value:`$${o}`,color:"red-600"}),e.jsx(x,{name:"delievery fee",value:`$${l}`}),e.jsx(x,{name:"total price",value:`$${L}`})]}),e.jsxs(u,{classes:"flex-nowrap gap-2 my-2 ",children:[e.jsx("input",{className:"flex flex-grow rounded-full bg-stone-200 px-4 py-2",placeholder:"Apply promo code"}),e.jsx(m,{type:"primary",children:"apply"})]}),e.jsx("div",{className:"mx-auto my-2 w-[16rem] md:w-96",children:e.jsxs(j,{children:[e.jsx(j.Open,{children:e.jsxs(m,{type:"primary",enlarge:!1,children:["Go to checkout",e.jsx("span",{className:"mx-2 transition-all hover:translate-x-8",children:"â†’"})]})}),e.jsx(j.Window,{children:e.jsx(de,{onSubmit:F,isCheckingOut:h})})]})})]})}function ye(){return e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsxs(H,{className:"px-2",children:[e.jsx(ee,{}),e.jsxs(u,{classes:"flex-wrap gap-2",children:[e.jsx(Z,{}),e.jsx(ue,{})]})]}),e.jsx(X,{}),e.jsx(U,{})]})}export{ye as default};
